<% content_for(:per_page_js, google_maps_js) %>
<% @title_args = {id: @response.decorate.shortcode} %>

<!-- TODO: This link should be conditional (like edit mode, read-only mode, etc.) -->
<%= link_to(t("response.use_nemo"), params.permit!.merge("enketo": "")) %>

<div id="enketo" class="enketo-form"></div>

<!-- TODO: This button should be conditional (like edit mode, read-only mode, etc.) -->
<!-- Button action is handled by Enketo JS. -->
<button id="enketo-submit" type="button" class="btn btn-primary"
        data-response-shortcode="<%= @response&.shortcode %>">
  <%= I18n.t("common.submit") %>
</button>

<script>
  let enketoFormObj = <%= @enketo_form_obj.presence || "{}" %>;
  window.ENKETO_MODEL_STR = enketoFormObj.model;
  $("#enketo").html(enketoFormObj.form);

  let enketoInstanceStr = <%= @enketo_instance_str.presence || "null" %>;
  window.ENKETO_INSTANCE_STR = enketoInstanceStr;
</script>

<% content_for(:powered_by) do %>
  <%= render(partial: "powered_by_enketo") %>
<% end %>

<%= javascript_pack_tag 'enketo' %>
